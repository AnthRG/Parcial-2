<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Mi Blog</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Estilos personalizados -->
  <style>
    .blog-header {
      line-height: 1;
      border-bottom: 1px solid #000000;
    }

    .blog-header-logo {
      font-family: "Playfair Display", Georgia, "Times New Roman", serif;
      font-size: 2.25rem;
    }

    .blog-header-logo:hover {
      text-decoration: none;
    }

    .blog-post-title {
      font-size: 2.5rem;
    }

    .blog-post-meta {
      color: #ffffff;
    }
  </style>
</head>
<body>

<div class="container">
  <header class="blog-header py-3">
    <div class="row flex-nowrap justify-content-between align-items-center">
      <div class="col-4 pt-1">
        <a class="link-secondary" href="#">Suscribirse</a>
      </div>
      <div class="col-4 text-center">
        <a class="blog-header-logo text-dark" href="#">Mi Blog</a>
      </div>
      <div class="col-4 d-flex justify-content-end align-items-center">
        <a class="btn btn-sm btn-outline-secondary" href="#">Iniciar sesión</a>
      </div>
    </div>
  </header>

  <div class="nav-scroller py-1 mb-2">
    <nav class="nav nav-underline justify-content-between">
      <a class="nav-item nav-link link-body-emphasis active" href="#">World</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">U.S.</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Technology</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Design</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Culture</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Business</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Politics</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Opinion</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Science</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Health</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Style</a>
      <a class="nav-item nav-link link-body-emphasis" href="#">Travel</a>
    </nav>
  </div>
</div>

<main class="container">
  <!-- Contenedor para los artículos generados dinámicamente -->
  <div id="articulos"></div>

  <div class="row g-5">
    <div class="col-md-8">
      <h3 class="pb-4 mb-4 fst-italic border-bottom">
        Desde el Archivo
      </h3>
      <article class="blog-post">
        <h2 class="blog-post-title">Título de la publicación</h2>
        <p class="blog-post-meta">1 de enero de 2023 por <a href="#">Autor</a></p>

        <p>Este es un contenido de ejemplo para mostrar cómo se vería una publicación en tu blog.</p>
        <hr>
        <p>Puedes agregar más contenido aquí, como imágenes, videos, o cualquier otro elemento HTML.</p>
        <blockquote>
          <p>Citas o referencias pueden ir aquí.</p>
        </blockquote>
        <p>Y más contenido...</p>
      </article>

      <nav class="blog-pagination" aria-label="Pagination">
        <a class="btn btn-outline-primary" href="#">Publicaciones antiguas</a>
        <a class="btn btn-outline-secondary disabled" href="#" tabindex="-1" aria-disabled="true">Publicaciones
          nuevas</a>
      </nav>
    </div>

    <div class="col-md-4">
      <div class="position-sticky" style="top: 2rem;">
        <div class="p-4 mb-3 bg-light rounded">
          <h4 class="fst-italic">Acerca de</h4>
          <p class="mb-0">Este es un espacio para una breve descripción sobre ti o tu blog.</p>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Script para cargar artículos dinámicamente -->
<script>
  async function cargarArticulos(cantidad) {
    try {
      const response = await fetch(`/articulos?cantidad=${cantidad}`);
      if (!response.ok) {
        throw new Error(`Error al cargar artículos: ${response.statusText}`);
      }
      const articulos = await response.json();

      const contenedor = document.getElementById('articulos');
      contenedor.innerHTML = ''; // Limpiar el contenedor

      // Crear una fila para los artículos
      const filaHTML = document.createElement('div');
      filaHTML.className = 'row'; // Usar la clase "row" de Bootstrap

      articulos.forEach(articulo => {
        // Limitar el contenido del cuerpo a 100 caracteres
        const contenidoLimitado = articulo.cuerpo.length > 100
                ? articulo.cuerpo.substring(0, 100) + "..."
                : articulo.cuerpo;

        // Asegurarse de que `etiquetas` sea un array
        const etiquetas = articulo.listaEtiquetas || []; // Si `etiquetas` es undefined, usar un array vacío
        const fechaFormateada = formatearFecha(articulo.fecha);

        // Mostrar hasta dos etiquetas
        const etiquetasHTML = etiquetas.slice(0, 2).map(etiqueta =>
                `${etiqueta.etiqueta}`
        ).join(', ');

        // Crear la tarjeta del artículo
        const articuloHTML = `
                    <div class="col-md-6"> <!-- Cada artículo ocupa la mitad del ancho -->
                        <div class="row g-0 border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
                            <div class="col p-4 d-flex flex-column position-static">
                                <strong class="d-inline-block mb-2 text-primary">Etiquetas: ${etiquetasHTML}.</strong>
                                <h3 class="mb-0">${articulo.titulo}</h3>
                                <div class="mb-1 text-muted">${fechaFormateada}</div>
                                <p class="card-text mb-auto">${contenidoLimitado}
                                <a href="#" class="stretched-link">Continuar leyendo</a>
                                </p>
                            </div>
                        </div>
                    </div>
                `;

        // Agregar el artículo a la fila
        filaHTML.innerHTML += articuloHTML;
      });

      // Agregar la fila al contenedor
      contenedor.appendChild(filaHTML);
    } catch (error) {
      console.error(error);
      const contenedor = document.getElementById('articulos');
      contenedor.innerHTML = `<p class="text-danger">Error al cargar los artículos: ${error.message}</p>`;
    }
  }

  function formatearFecha(fecha) {
    const opciones = {year: 'numeric', month: 'long', day: 'numeric'};
    return new Date(fecha).toLocaleDateString('es-ES', opciones);
  }

  // Cargar artículos al cargar la página
  document.addEventListener('DOMContentLoaded', () => cargarArticulos(2));
</script>
</script>
</body>
</html>